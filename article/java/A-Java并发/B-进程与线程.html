<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.60" />
    <meta name="theme" content="VuePress Theme Hope" />
    <link rel="icon" href="https://my-photos-1.oss-cn-hangzhou.aliyuncs.com/Individual/logo.png"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#21332d"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><link rel="icon" href="/logo.png"><title>进程与线程</title><meta name="description" content="进程与线程">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-42911d78.css" as="style"><link rel="stylesheet" href="/assets/style-42911d78.css">
    <link rel="modulepreload" href="/assets/app-f746a503.js"><link rel="modulepreload" href="/assets/framework-ec2af7a3.js"><link rel="modulepreload" href="/assets/B-进程与线程.html-fc5717b9.js"><link rel="modulepreload" href="/assets/B-进程与线程.html-ddd1b000.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to main content</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><!----><!----><!----></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="主页"><FontIcon icon="zhuye"></FontIcon>主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/guide/" class="nav-link" aria-label="导航"><FontIcon icon="tubiaozhuanqu-16"></FontIcon>导航<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="编程语言"><span class="title"><FontIcon icon="code"></FontIcon>编程语言</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/article/java/" class="nav-link active" aria-label="Java"><FontIcon></FontIcon>Java<!----></a></li><li class="dropdown-item"><a href="/article/go/" class="nav-link" aria-label="Go"><FontIcon></FontIcon>Go<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/article/algorithm/" class="nav-link" aria-label="算法"><FontIcon icon="jichengsuanfa"></FontIcon>算法<!----></a></div><div class="nav-item hide-in-mobile"><a href="/article/springs/" class="nav-link" aria-label="Springs"><FontIcon icon="bxl-spring-boot"></FontIcon>Springs<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="数据库"><span class="title"><FontIcon icon="database-full"></FontIcon>数据库</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/article/mysql/" class="nav-link" aria-label="MySQL"><FontIcon></FontIcon>MySQL<!----></a></li><li class="dropdown-item"><a href="/article/redis/" class="nav-link" aria-label="Redis"><FontIcon></FontIcon>Redis<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="设计"><span class="title"><FontIcon icon="sheji1"></FontIcon>设计</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/article/design/" class="nav-link" aria-label="设计模式"><FontIcon></FontIcon>设计模式<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="中间件"><span class="title"><FontIcon icon="zhongjianjian"></FontIcon>中间件</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/article/rabbitmq/" class="nav-link" aria-label="RabbitMQ"><FontIcon></FontIcon>RabbitMQ<!----></a></li><li class="dropdown-item"><a href="/article/elasticsearch/" class="nav-link" aria-label="ElasticSearch"><FontIcon></FontIcon>ElasticSearch<!----></a></li><li class="dropdown-item"><a href="/article/mongodb/" class="nav-link" aria-label="Mongodb"><FontIcon></FontIcon>Mongodb<!----></a></li><li class="dropdown-item"><a href="/article/netty/" class="nav-link" aria-label="Netty"><FontIcon></FontIcon>Netty<!----></a></li><li class="dropdown-item"><a href="/article/quartz/" class="nav-link" aria-label="Quartz"><FontIcon></FontIcon>Quartz<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="运维"><span class="title"><FontIcon icon="yunwei-yunweirizhi"></FontIcon>运维</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/article/git/" class="nav-link" aria-label="Git"><FontIcon></FontIcon>Git<!----></a></li><li class="dropdown-item"><a href="/article/docker/" class="nav-link" aria-label="Docker"><FontIcon></FontIcon>Docker<!----></a></li><li class="dropdown-item"><a href="/article/jenkins/" class="nav-link" aria-label="Jenkins"><FontIcon></FontIcon>Jenkins<!----></a></li><li class="dropdown-item"><a href="/article/linux/" class="nav-link" aria-label="Linux"><FontIcon></FontIcon>Linux<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/article/modeling/" class="nav-link" aria-label="数学建模"><FontIcon icon="qita"></FontIcon>数学建模<!----></a></div><div class="nav-item hide-in-mobile"><a href="/article/other/" class="nav-link" aria-label="其他文章"><FontIcon icon="qita"></FontIcon>其他文章<!----></a></div><div class="nav-item hide-in-mobile"><a href="/about/" class="nav-link" aria-label="关于"><FontIcon icon="guanyu1"></FontIcon>关于<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><!----><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!--[--><button class="search-pro-button" role="search" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg></button><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/article/java/" class="nav-link sidebar-link sidebar-page" aria-label="Java"><FontIcon></FontIcon>Java<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/article/java/%E9%80%83%E9%80%B8%E5%88%86%E6%9E%90.html" class="nav-link sidebar-link sidebar-page" aria-label="逃逸分析"><FontIcon></FontIcon>逃逸分析<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/article/java/%E6%B3%A8%E8%A7%A3%E4%B8%8E%E5%8F%8D%E5%B0%84.html" class="nav-link sidebar-link sidebar-page" aria-label="注解与反射"><FontIcon></FontIcon>注解与反射<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/article/java/Java%E5%9F%BA%E7%A1%80%E9%94%99%E9%A2%98%E9%9B%86.html" class="nav-link sidebar-link sidebar-page" aria-label="Java 基础错题集"><FontIcon></FontIcon>Java 基础错题集<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/article/java/Java%E7%9B%91%E6%8E%A7.html" class="nav-link sidebar-link sidebar-page" aria-label="Java 监控"><FontIcon></FontIcon>Java 监控<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/article/java/Java%E5%BC%82%E5%B8%B8.html" class="nav-link sidebar-link sidebar-page" aria-label="Java 异常"><FontIcon></FontIcon>Java 异常<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/article/java/Java%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB.html" class="nav-link sidebar-link sidebar-page" aria-label="Java 源码阅读"><FontIcon></FontIcon>Java 源码阅读<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/article/java/JavaIO%E6%B5%81.html" class="nav-link sidebar-link sidebar-page" aria-label="JavaIO流"><FontIcon></FontIcon>JavaIO流<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/article/java/JVM.html" class="nav-link sidebar-link sidebar-page" aria-label="JVM"><FontIcon></FontIcon>JVM<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><FontIcon></FontIcon><span class="title">A Java并发</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/article/java/A-Java%E5%B9%B6%E5%8F%91/A-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5.html" class="nav-link sidebar-link sidebar-page" aria-label="A-Java 并发基本概念"><FontIcon></FontIcon>A-Java 并发基本概念<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="B-进程与线程"><FontIcon></FontIcon>B-进程与线程<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_1-进程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.进程"><FontIcon></FontIcon>1.进程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_2-线程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.线程"><FontIcon></FontIcon>2.线程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_3-多线程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.多线程"><FontIcon></FontIcon>3.多线程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_4-创建线程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.创建线程"><FontIcon></FontIcon>4.创建线程<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_4-1-thread" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.1 Thread"><FontIcon></FontIcon>4.1 Thread<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_4-2-runnable" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.2 Runnable"><FontIcon></FontIcon>4.2 Runnable<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_4-3-futuretask" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.3 FutureTask"><FontIcon></FontIcon>4.3 FutureTask<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_5-线程运行原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.线程运行原理"><FontIcon></FontIcon>5.线程运行原理<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_5-1-栈与栈帧" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.1 栈与栈帧"><FontIcon></FontIcon>5.1 栈与栈帧<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_5-2-线程上下文切换" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.2 线程上下文切换"><FontIcon></FontIcon>5.2 线程上下文切换<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-线程的主要方法" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.线程的主要方法"><FontIcon></FontIcon>6.线程的主要方法<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-1-run-与-start" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.1 run 与 start"><FontIcon></FontIcon>6.1 run 与 start<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-2-sleep-与-yield" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.2 sleep 与 yield"><FontIcon></FontIcon>6.2 sleep 与 yield<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-3-join" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.3 join"><FontIcon></FontIcon>6.3 join<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-4-interrupt-与-park" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.4 interrupt 与 park"><FontIcon></FontIcon>6.4 interrupt 与 park<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-5-stop、suspend-与-resume" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.5 stop、suspend 与 resume"><FontIcon></FontIcon>6.5 stop、suspend 与 resume<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-6-wait-notify" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.6 wait / notify"><FontIcon></FontIcon>6.6 wait / notify<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-7-locksupport-的-park-和-unpark" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.7 LockSupport 的 park 和 unpark"><FontIcon></FontIcon>6.7 LockSupport 的 park 和 unpark<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_7-线程停止的方法" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.线程停止的方法"><FontIcon></FontIcon>7.线程停止的方法<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_8-主线程与守护线程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.主线程与守护线程"><FontIcon></FontIcon>8.主线程与守护线程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_9-线程的状态" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9.线程的状态"><FontIcon></FontIcon>9.线程的状态<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/article/java/A-Java%E5%B9%B6%E5%8F%91/C-Java%E9%94%81.html" class="nav-link sidebar-link sidebar-page" aria-label="C-Java 锁"><FontIcon></FontIcon>C-Java 锁<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/article/java/A-Java%E5%B9%B6%E5%8F%91/D-Java%20%E5%B9%B6%E5%8F%91%E5%85%B1%E4%BA%AB%E6%A8%A1%E5%9E%8B%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89.html" class="nav-link sidebar-link sidebar-page" aria-label="D-Java 并发共享模型（重点）"><FontIcon></FontIcon>D-Java 并发共享模型（重点）<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/article/java/A-Java%E5%B9%B6%E5%8F%91/E-JUC%E5%B7%A5%E5%85%B7.html" class="nav-link sidebar-link sidebar-page" aria-label="E-JUC 工具"><FontIcon></FontIcon>E-JUC 工具<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/article/java/A-Java%E5%B9%B6%E5%8F%91/F-Java%E5%B9%B6%E5%8F%91%E5%90%8C%E6%AD%A5%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="F-Java 并发同步模式"><FontIcon></FontIcon>F-Java 并发同步模式<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/article/java/A-Java%E5%B9%B6%E5%8F%91/G-Java%E5%B9%B6%E5%8F%91%E5%BC%82%E6%AD%A5%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="G-Java 并发异步模式"><FontIcon></FontIcon>G-Java 并发异步模式<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/article/java/A-Java%E5%B9%B6%E5%8F%91/H-Java%E9%94%81%E4%BC%98%E5%8C%96.html" class="nav-link sidebar-link sidebar-page" aria-label="H-Java 锁优化"><FontIcon></FontIcon>H-Java 锁优化<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><div><!----><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><FontIcon icon></FontIcon>进程与线程</h1><div class="page-info"><span class="page-author-info" aria-label="Author🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">gzw</span></span><span property="author" content="gzw"></span></span><!----><span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-02-07T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 13 min</span><meta property="timeRequired" content="PT13M"></span><span class="page-category-info" aria-label="Category🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="page-category-item category6 clickable" role="navigation">java</span><span class="page-category-item category6 clickable" role="navigation">并发</span><meta property="articleSection" content="java,并发"></span><span class="page-tag-info" aria-label="Tag🏷" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><span class="page-tag-item tag6 clickable" role="navigation">java</span><span class="page-tag-item tag6 clickable" role="navigation">并发</span><meta property="keywords" content="java,并发"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">On This Page<button class="print-button" title="print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#进程与线程" class="router-link-active router-link-exact-active toc-link level1">进程与线程</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_1-进程" class="router-link-active router-link-exact-active toc-link level2">1.进程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_2-线程" class="router-link-active router-link-exact-active toc-link level2">2.线程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_3-多线程" class="router-link-active router-link-exact-active toc-link level2">3.多线程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_4-创建线程" class="router-link-active router-link-exact-active toc-link level2">4.创建线程</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_4-1-thread" class="router-link-active router-link-exact-active toc-link level3">4.1 Thread</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_4-2-runnable" class="router-link-active router-link-exact-active toc-link level3">4.2 Runnable</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_4-3-futuretask" class="router-link-active router-link-exact-active toc-link level3">4.3 FutureTask</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_5-线程运行原理" class="router-link-active router-link-exact-active toc-link level2">5.线程运行原理</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_5-1-栈与栈帧" class="router-link-active router-link-exact-active toc-link level3">5.1 栈与栈帧</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_5-2-线程上下文切换" class="router-link-active router-link-exact-active toc-link level3">5.2 线程上下文切换</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-线程的主要方法" class="router-link-active router-link-exact-active toc-link level2">6.线程的主要方法</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-1-run-与-start" class="router-link-active router-link-exact-active toc-link level3">6.1 run 与 start</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-2-sleep-与-yield" class="router-link-active router-link-exact-active toc-link level3">6.2 sleep 与 yield</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-3-join" class="router-link-active router-link-exact-active toc-link level3">6.3 join</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-4-interrupt-与-park" class="router-link-active router-link-exact-active toc-link level3">6.4 interrupt 与 park</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-5-stop、suspend-与-resume" class="router-link-active router-link-exact-active toc-link level3">6.5 stop、suspend 与 resume</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-6-wait-notify" class="router-link-active router-link-exact-active toc-link level3">6.6 wait / notify</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_6-7-locksupport-的-park-和-unpark" class="router-link-active router-link-exact-active toc-link level3">6.7 LockSupport 的 park 和 unpark</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_7-线程停止的方法" class="router-link-active router-link-exact-active toc-link level2">7.线程停止的方法</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_8-主线程与守护线程" class="router-link-active router-link-exact-active toc-link level2">8.主线程与守护线程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/article/java/A-Java%E5%B9%B6%E5%8F%91/B-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html#_9-线程的状态" class="router-link-active router-link-exact-active toc-link level2">9.线程的状态</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="进程与线程" tabindex="-1"><a class="header-anchor" href="#进程与线程" aria-hidden="true">#</a> 进程与线程</h1><h2 id="_1-进程" tabindex="-1"><a class="header-anchor" href="#_1-进程" aria-hidden="true">#</a> 1.进程</h2><ul><li>加载指令、管理内存、管理 IO</li><li>当程序代码从磁盘加载到内存便开启了一个进程</li><li>进程是一个程序的实例，大多数程序可以同时运行多个进程</li><li>进程拥有共享的资源：内存、空间等，共其内部的线程共享</li><li>进程间的通信较为复杂，同一台计算机的进程通信成为 IPC；不同计算机之间的进程通信需要通过网络并遵守共同的协议（如：HTTP）</li></ul><h2 id="_2-线程" tabindex="-1"><a class="header-anchor" href="#_2-线程" aria-hidden="true">#</a> 2.线程</h2><ul><li><p>一个进程内可以分为多个线程</p></li><li><p>一个线程就是一个指令流，线程会将这个指令流中的命令一条条地交给 CPU 执行</p></li><li><p>Java 中，线程作为最小的调度单位，进程作为资源分配的最小单位</p></li><li><p>在 Windows 中，进程是不活动的，只是作为线程的容器</p></li><li><p>多个线程可以访问同一个共享变量</p></li><li><p>线程的上下文切换的成本一般比进程的上下文切换低</p></li></ul><h2 id="_3-多线程" tabindex="-1"><a class="header-anchor" href="#_3-多线程" aria-hidden="true">#</a> 3.多线程</h2><p><strong>1.值得注意的是：</strong></p><ul><li>IO 操作是不占用 CPU 的，只是我们拷贝文件使用的是阻塞 IO，这时即使不占用 CPU 也还是要等待 IO 结束，没有充分利用到线程</li><li>这种情况下可以使用非阻塞 IO 或异步 IO 解决</li></ul><p><strong>2.优势：</strong></p><ul><li>可以实现异步操作，避免阻塞</li><li>在 CPU 是多核的情况下可以提高程序的效率</li><li>单核 CPU 下多线程一般会比单线程慢，因为多线程还要切换不同线程，这也是一个耗时的操作。但是这不意味着单核下多线程没有用，因为轮流切换线程可以任务使不同任务得以进行，不至于让单个程序一直占用 CPU</li></ul><h2 id="_4-创建线程" tabindex="-1"><a class="header-anchor" href="#_4-创建线程" aria-hidden="true">#</a> 4.创建线程</h2><p><strong>三种方式创建线程：</strong></p><ul><li>Thread 类</li><li>Runnable 接口</li><li>FutureTask<code>&lt;V&gt;</code> 类 <ul><li>FutureTask 实现了 RunnableFuture 接口，而 RunnableFuture 继承了 Runnable 接口和 Future<code>&lt;V&gt;</code> 接口（接口可以多继承，类不行），这可以返回一个任务的执行结果（Runnable 没有返回值），多线程操作间更加方便</li><li>FutureTask 可以接收 Callable 类型的参数（Callable 与 Runnable 类似，前者比后者多了返回值并且可以抛出异常），以此来处理有返回值的情况</li><li>Callable 接口中只有一个 call 方法，并且使用了 @FunctionalInterface 注解</li></ul></li></ul><p><strong>【注意】一般更推荐使用 Runnable 接口的创建方式，，因为这让 Runnable 任务脱离了 Thread 的继承体系，即：使得任务和线程创建分开（意味着更灵活），并且常常使用 lambda 表达式简化。此外，使用 Runnable 还更容易与线程池等高级 API 结合</strong></p><h3 id="_4-1-thread" tabindex="-1"><a class="header-anchor" href="#_4-1-thread" aria-hidden="true">#</a> 4.1 Thread</h3><p><strong>直接使用 Thread 创建线程：</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CreateByThread</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">CreateByThread</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;通过 thread 直接创建线程...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">// 给线程命名</span>
        thread<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;thread-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 启动线程</span>
        thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;main方法...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-2-runnable" tabindex="-1"><a class="header-anchor" href="#_4-2-runnable" aria-hidden="true">#</a> 4.2 Runnable</h3><p><strong>1.使用 Runnable 接口创建线程：</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CreateByRunnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">CreateByRunnable</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">Runnable</span> runnable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;通过 runnable 接口创建线程...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">// 创建线程，同时给线程命名</span>
        <span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>runnable<span class="token punctuation">,</span> <span class="token string">&quot;thread-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 启动线程</span>
        thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;main方法...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>2.使用 lambda 表达式的条件</strong></p><ul><li>接口中只有一个方法</li><li>使用了 @FunctionalInterface 注解</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// 使用 lambda 表达式创建</span>
<span class="token class-name">Runnable</span> runnable1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;通过 runnable 接口创建线程...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 当方法体只有一句话时可以去掉大括号</span>
<span class="token class-name">Runnable</span> runnable2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;通过 runnable 接口创建线程...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 最简化的线程创建方式，等价于：Thread thread1 = new Thread(runnable2, &quot;thread-1&quot;);</span>
<span class="token class-name">Thread</span> thread1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;通过 runnable 接口创建线程...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;thread-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-3-futuretask" tabindex="-1"><a class="header-anchor" href="#_4-3-futuretask" aria-hidden="true">#</a> 4.3 FutureTask</h3><p><strong>使用 FutureTask 方式创建：</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CreateByFutureTask</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">CreateByFutureTask</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ExecutionException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 创建具有返回值的任务</span>
        <span class="token class-name">FutureTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FutureTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
                logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;创建任务...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;任务结束...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token number">1000</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 创建线程</span>
        <span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token string">&quot;thread-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 开启线程执行任务</span>
        thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 下面的语句是等待线程结束并返回了结果才执行</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;执行时间：{} ms&quot;</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-线程运行原理" tabindex="-1"><a class="header-anchor" href="#_5-线程运行原理" aria-hidden="true">#</a> 5.线程运行原理</h2><h3 id="_5-1-栈与栈帧" tabindex="-1"><a class="header-anchor" href="#_5-1-栈与栈帧" aria-hidden="true">#</a> 5.1 栈与栈帧</h3><ul><li>JVM 由堆、栈、方法区组成，其中栈内存就是给线程用的，每启动一个线程，虚拟机就会为其分配一块栈内存</li><li>每个栈由多个栈帧（Frame）组成，对应着每次方法调用时所占的内存</li><li>每个线程只能有一个活动栈帧，对应着当前执行的方法</li><li>不同的线程间的栈内存是互不干扰的</li></ul><h3 id="_5-2-线程上下文切换" tabindex="-1"><a class="header-anchor" href="#_5-2-线程上下文切换" aria-hidden="true">#</a> 5.2 线程上下文切换</h3><p><strong>1.切换时机：</strong></p><ul><li>线程的 CPU 时间片用完</li><li>执行垃圾回收时</li><li>有更高优先级的线程需要运行</li><li>线程自己调用了 sleep、yield、wait、join、park、synchronized、lock等方法</li></ul><p><strong>2.切换发生时：</strong></p><ul><li>需要由操作系统保存当前线程的状态并恢复另一个线程的状态，Java 中对应的概念就是程序计数器，他的作用是记住下一条 jvm 指令的执行地址，这是线程私有的</li><li>状态包括程序计数器、虚拟机栈中每个栈帧的信息，如局部变量、操作数栈、返回地址等</li><li>线程上下文频繁地切换会影响性能</li></ul><h2 id="_6-线程的主要方法" tabindex="-1"><a class="header-anchor" href="#_6-线程的主要方法" aria-hidden="true">#</a> 6.线程的主要方法</h2><h3 id="_6-1-run-与-start" tabindex="-1"><a class="header-anchor" href="#_6-1-run-与-start" aria-hidden="true">#</a> 6.1 run 与 start</h3><ul><li>创建线程后可以直接调用 run 方法，但是这样执行者就变成了 main 线程，没有提高性能，只有使用 start 方法才能由创建的线程执行该任务</li><li>start 方法是不能重复调用的</li></ul><h3 id="_6-2-sleep-与-yield" tabindex="-1"><a class="header-anchor" href="#_6-2-sleep-与-yield" aria-hidden="true">#</a> 6.2 sleep 与 yield</h3><ul><li>sleep 会让当前线程从 Runnable 进入 Time waiting 阻塞状态，其他线程可以使用 interrupt 方法打断正在睡眠的线程，这时 sleep 会抛出 InterruptException</li><li>睡眠结束后的线程未必会立刻得到执行；建议使用 TimeUnit 的 sleep 代替 Thread 的 sleep 来获得更好的可读性</li><li>yield 会让当前线程从 Running 进入 Runnable 就绪状态，然后调度执行其他同优先级的线程，此时如果没有同优先级的线程，那么不能保证能让当前线程暂停的效果。yield 具体的实现依赖于操作系统的任务调度器</li><li>调度器只会把时间片分给 Runnable 状态的线程而不会分给 Time Waiting 状态的线程</li><li>sleep 会有一个真正的休眠时间，yield 在没有其他线程的情况下还是会继续本线程</li><li>线程优先级会提示（hint）调度器优先调度优先级高的线程，但这仅仅是一个提示，调度器是可以忽略掉的。如果 CPU 比较忙，那么优先级高的线程会获得更加多的时间片，但 CPU 闲时，优先级几乎没作用</li></ul><h3 id="_6-3-join" tabindex="-1"><a class="header-anchor" href="#_6-3-join" aria-hidden="true">#</a> 6.3 join</h3><ul><li>等待调用 join 的线程执行完成后再继续执行当前线程的</li><li>join 是用来同步线程的</li><li>join 可以带参数，倘若参数设置的时长小于线程的总时常，那么就会提前打断线程；倘若设置的时常大于线程的总时常，那么在线程任务完成后会直接结束而不是继续等待，这也是带参数时和 sleep 方法的区别</li><li>join 方法使用了保护性暂停模式（详见第三大点）</li></ul><h3 id="_6-4-interrupt-与-park" tabindex="-1"><a class="header-anchor" href="#_6-4-interrupt-与-park" aria-hidden="true">#</a> 6.4 interrupt 与 park</h3><ul><li>interrupt 方法用于打断线程，见 1.7 所示</li><li>park 方法可以让线程停止，之后的代码不会执行，用 interrupt 可以打断这种状态</li><li>注意，在打断标记为 true 时，park 方法会失效，将打断标记置为真即可（使用interrupted，见 1.7 解释）</li></ul><h3 id="_6-5-stop、suspend-与-resume" tabindex="-1"><a class="header-anchor" href="#_6-5-stop、suspend-与-resume" aria-hidden="true">#</a> 6.5 stop、suspend 与 resume</h3><ul><li>三个方法都不建议使用，已经过时，容易破坏同步代码块，造成线程死锁。其都有对应的解决方法</li><li>stop 方法用于立即停止线程运行；suspend 方法用于挂起（暂停）线程运行；resume 方法用于恢复线程运行。</li></ul><h3 id="_6-6-wait-notify" tabindex="-1"><a class="header-anchor" href="#_6-6-wait-notify" aria-hidden="true">#</a> 6.6 wait / notify</h3><ul><li>Monitor 中的 Owner 线程发现条件不满足时，调用 wait 方法，即可让线程进入 WaitSet 变为 Waiting 状态</li><li>Blocked 和 Waiting 的线程都会处于阻塞状态，不占用 CPU 时间片</li><li>Blocked 线程会在 Owner 线程释放锁时唤醒</li><li>Waiting 线程会在 Owner 线程调用 notify 或 notifyAll 时唤醒，但是唤醒后并不意味着立即获得锁，仍需要进入 EntryList 中重新竞争</li><li>上述方法都是线程之间进行协作的手段，都是属于 object 对象的方法。必须要获取对象的锁才能调用这几个方法</li></ul><p><strong>1.相关 API</strong></p><ul><li>obj.wait：让进入 object monitor 的线程到 WaitSet 等待。不带参数或者参数为 0 的 wait 方法表示无限制等待下去，参数是用于设置超时时间的（timeout）。特别注意 wait 方法还有两个参数（另一个为 nanos）的重载，但是 nanos 参数并不能精确到纳秒，通过源码可以发现，当 nanos 大于 0 时会直接将 timeout 的值加一</li><li>obj.notify：在 object 上正在 WaitSet 等待的线程中挑一个唤醒</li><li>obj.notifyAll：让 object 上正在 WaitSet 等待的线程全部唤醒</li></ul><p><strong>2.基本用法</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BaseUsage</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">BaseUsage</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;执行...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 进入 WaitSet 等待</span>
                    o<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// 唤醒后才执行的操作</span>
                logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;唤醒操作...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;t1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;执行...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 进入 WaitSet 等待</span>
                    o<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// 唤醒后才执行的操作</span>
                logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;唤醒操作...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;t2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 主线程休息 1 秒后随机唤醒一个线程</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;执行...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            o<span class="token punctuation">.</span><span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>3.sleep 和 wait 的区别</strong></p><ul><li>sleep 是 Thread 的方法，而 wait 是 Object 的方法</li><li>sleep 不需要强制和 synchronized 配合使用，但是 wait 需要和 synchronized 一起使用</li><li>sleep 在睡眠的同时不会释放对象锁，但是 wait 在等待时会释放对象锁</li></ul><h3 id="_6-7-locksupport-的-park-和-unpark" tabindex="-1"><a class="header-anchor" href="#_6-7-locksupport-的-park-和-unpark" aria-hidden="true">#</a> 6.7 LockSupport 的 park 和 unpark</h3><ul><li>LockSupport.park 用于暂停当前线程；LockSupport.unpark 用于恢复某个线程的运行</li><li>与 Object 的 wait 与 notify(All) 相比 <ul><li>wait，notify 和 notifyAll 必须配合 Object Monitor 一起使用，而 unpark 不需要</li><li>park 和 unpark 是以线程为单位来阻塞和唤醒线程，而 notify 只能随机唤醒一个等待线程，notifyAll 是唤醒所有的等待线程（不那么精确）</li><li>park 和 unpark 可以先 unpark，而 wait 和 notify 不能先 notify</li></ul></li></ul><p><strong>park 和 unpark 原理</strong></p><ul><li>每个线程都有自己的一个 Parker 对象（有 C 实现，在 Java 中不可见），有三部分组成：_ count、_ cond、_ mutex（互斥锁）</li><li>线程就像一个旅人，Parker 就像他随身携带的背包，条件变量（_ cond）就好比背包中的帐篷；_ count 就好比背包中的备用干粮（0 为耗尽，1 为充足）</li><li>调用 park 就是要看需不需要停下来休息 <ul><li>如果干粮耗尽，那么就钻进帐篷休息</li><li>如果备用干粮充足，那么不需要停留，继续前进</li></ul></li><li>调用 unpark 就好比令干粮充足 <ul><li>如果此时线程还在帐篷中，就唤醒让他继续前进</li><li>如果这时线程还在运行，那么下次他调用 park 时，仅是消耗掉备用干粮，不需要停留继续前进。因为背包空间有限，多次调用 unpark 仅会补充一份备用干粮</li></ul></li></ul><h2 id="_7-线程停止的方法" tabindex="-1"><a class="header-anchor" href="#_7-线程停止的方法" aria-hidden="true">#</a> 7.线程停止的方法</h2><p>【注意】</p><ul><li>抛出的异常被捕获处理后，之后的代码都可以正常执行，这就是为什么下面捕获异常后循环还在继续</li><li>但是如果将异常往上抛出，那么之后的代码就不可以继续执行</li></ul><p>【注意】</p><ul><li>下面使用的 isInterrupted 方法是用于判断线程是否被打断的，不会清除打断标记</li><li>而与之相像的另外一个方法 interrupted 也是判断线程是否被打断，但是会清除打断标记</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TwoPhaseTermination</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Termination</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Termination</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Termination</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">Termination</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Thread</span> monitor<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 启动线程
     * 在其中判断线程是否被打断
     * 打断则释放资源后再结束
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        monitor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 获取当前线程</span>
                <span class="token class-name">Thread</span> cur <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span><span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;释放资源...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 结束线程</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 情况1：在该处被打断的话，interrupt 的状态会被重新置成 false，无法停止线程，类似的还有 wait、join</span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 情况2：在该处被打断则 interrupt 状态为直接被置为 true</span>
                    logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;执行监控记录...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 因为情况1在抛出异常后 interrupt 状态是 false，所以此处还需要重新置为 true</span>
                    cur<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;t1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        monitor<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 不使用线程自带的 stop 方法
     * 因为停止后线程持有的资源可能释放不了
     * 应该使用 interrupt 方法代替
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        monitor<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_8-主线程与守护线程" tabindex="-1"><a class="header-anchor" href="#_8-主线程与守护线程" aria-hidden="true">#</a> 8.主线程与守护线程</h2><ul><li>默认情况下，Java 进程需要等待所有的线程都运行结束才会结束</li><li>有一种特殊的线程叫守护线程，只要其他非守护线程结束了，就会强制结束（即使守护线程的代码没有执行完也会强制结束）</li><li>使用 setDaemon 方法（参数为 true）可以将线程设置成守护线程</li><li>垃圾回收器线程就是一种守护线程。Tomcat 中的 Acceptor 和 Poller 线程都是守护线程，所以 Tomcat 在收到 shutdown 命令后，不会等待它们处理完当前请求</li></ul><h2 id="_9-线程的状态" tabindex="-1"><a class="header-anchor" href="#_9-线程的状态" aria-hidden="true">#</a> 9.线程的状态</h2><p><strong>1.从操作系统层面描述（五种状态）</strong></p><ul><li>初始状态：仅是在语言层面创建了线程对象，还未与操作系统线程关联</li><li>可运行状态（就绪状态）：指该线程已经被创建（与操作系统线程相关联），可以由 CPU 调度执行</li><li>运行状态：指获取了 CPU 时间片运行中的状态</li><li>阻塞状态： <ul><li>如调用了阻塞 API，如 BIO 读写文件，这时该线程实际上不会使用到 CPU，会导致线程上下文切换，进入阻塞状态</li><li>等待操作完毕后，会由操作系统唤醒阻塞的线程，转换至可运行状态。</li><li>阻塞与可运行状态的区别是，对阻塞的线程来说只要它们一直不被唤醒，那么调度器就一直不会考虑调度它们</li></ul></li><li>终止状态：表示线程已经执行完毕，生命周期已经结束，不会再转换为其他状态</li></ul><p><strong>2.从 Java API 层面描述（六种状态，按照 Thread.State 枚举分类）</strong></p><p>使用 getState 方法可以获取线程当前的状态</p><ul><li>NEW：线程刚被创建，但是还没有调用 start 方法</li><li>RUNNABLE：当调用了 start 方法之后便进入可运行状态，涵盖了操作系统的： <ul><li>可运行状态</li><li>运行状态（由于 BIO 导致的线程阻塞 Java 是无法区分的，仍然认为是可运行）</li><li>阻塞状态</li></ul></li><li>TERMINATED：线程代码运行结束</li><li>Java 中三种特殊的阻塞： <ul><li>BLOCKED（如：加锁）</li><li>WAITING（如：join，wait）</li><li>TIMED_WAITING（如：sleep）</li></ul></li></ul></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">Last update: </span><!----></div><div class="contributors"><span class="label">Contributors: </span><!--[--><!--[--><span class="contributor" title="email: 1627121193@qq.com">格兹沃</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/article/java/A-Java%E5%B9%B6%E5%8F%91/A-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5.html" class="nav-link prev" aria-label="A-Java 并发基本概念"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><FontIcon></FontIcon>A-Java 并发基本概念</div></a><a href="/article/java/A-Java%E5%B9%B6%E5%8F%91/C-Java%E9%94%81.html" class="nav-link next" aria-label="C-Java 锁"><div class="hint">Next<span class="arrow end"></span></div><div class="link">C-Java 锁<FontIcon></FontIcon></div></a></nav><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><div data-v-717f1b97></div></div><!--]--><!----></div><!--]--><!--]--><!----><div id="pwa-install"><!----><div id="install-modal-wrapper" style="display:none;"><div class="background"></div><div class="install-modal"><div class="header"><button class="close-button" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="icon close-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="close icon"><path d="M589.654 511.965 1007.212 84.22a49.777 49.777 0 0 0-.73-70.02 49.046 49.046 0 0 0-69.687.665L519.967 441.946 85.882 14.2a49.08 49.08 0 0 0-69.687.664 49.777 49.777 0 0 0 .664 70.019l433.454 427.082L16.859 939.048a49.777 49.777 0 0 0-.664 70.019 49.013 49.013 0 0 0 69.687.663l434.085-427.746 416.828 427.083A49.013 49.013 0 0 0 972.037 1024a48.416 48.416 0 0 0 34.512-14.27 49.777 49.777 0 0 0 .73-70.019z"></path></svg></button><div class="logo"><!----><div class="title"><h1></h1><p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div><div class="content"><div class="highlight"><!----><!----></div><div class="description"><h3>Description</h3><p></p></div></div><div class="button-wrapper"><button class="install-button">Install<span></span></button><button class="cancel-button">Cancel</button></div></div></div></div><!----><!--]--></div>
    <script type="module" src="/assets/app-f746a503.js" defer></script>
  </body>
</html>
